(function(c){var g=[].slice,i={};c.amplify={publish:function(e){var c=g.call(arguments,1),f,a,h,n=0;if(!i[e])return!0;f=i[e].slice();for(h=f.length;n<h;n++)if(a=f[n],a=a.callback.apply(a.context,c),a===!1)break;return a!==!1},subscribe:function(e,c,f,a){arguments.length===3&&typeof f==="number"&&(a=f,f=c,c=null);arguments.length===2&&(f=c,c=null);for(var a=a||10,h=0,n=e.split(/\s/),d=n.length,b;h<d;h++){e=n[h];b=!1;i[e]||(i[e]=[]);for(var k=i[e].length-1,m={callback:f,context:c,priority:a};k>=0;k--)if(i[e][k].priority<=
a){i[e].splice(k+1,0,m);b=!0;break}b||i[e].unshift(m)}return f},unsubscribe:function(e,c){if(i[e])for(var f=i[e].length,a=0;a<f;a++)if(i[e][a].callback===c){i[e].splice(a,1);break}}}})(this);
(function(c,g){function i(a,d){e.addType(a,function(b,k,c){var h,f=k,o=(new Date).getTime();if(!b){f={};c=[];k=0;try{for(b=d.length;b=d.key(k++);)if(j.test(b))h=JSON.parse(d.getItem(b)),h.expires&&h.expires<=o?c.push(b):f[b.replace(j,"")]=h.data;for(;b=c.pop();)d.removeItem(b)}catch(p){}return f}b="__amplify__"+b;if(k===g)if(h=(h=d.getItem(b))?JSON.parse(h):{expires:-1},h.expires&&h.expires<=o)d.removeItem(b);else return h.data;else if(k===null)d.removeItem(b);else{h=JSON.stringify({data:k,expires:c.expires?
o+c.expires:null});try{d.setItem(b,h)}catch(i){e[a]();try{d.setItem(b,h)}catch(r){throw e.error();}}}return f})}var e=c.store=function(a,d,b,c){c=e.type;if(b&&b.type&&b.type in e.types)c=b.type;return e.types[c](a,d,b||{})};e.types={};e.type=null;e.addType=function(a,d){if(!e.type)e.type=a;e.types[a]=d;e[a]=function(b,d,c){c=c||{};c.type=a;return e(b,d,c)}};e.error=function(){return"amplify.store quota exceeded"};var j=/^__amplify__/,f;for(f in{localStorage:1,sessionStorage:1})try{window[f].getItem&&
i(f,window[f])}catch(a){}if(window.globalStorage)try{if(i("globalStorage",window.globalStorage[window.location.hostname]),e.type==="sessionStorage")e.type="globalStorage"}catch(h){}(function(){if(!e.types.localStorage){var a=document.createElement("div");a.style.display="none";document.getElementsByTagName("head")[0].appendChild(a);try{a.addBehavior("#default#userdata"),a.load("amplify")}catch(d){a.parentNode.removeChild(a);return}e.addType("userData",function(b,d,c){a.load("amplify");var h,f,o=d,
p=(new Date).getTime();if(!b){o={};f=[];for(b=0;d=a.XMLDocument.documentElement.attributes[b++];)h=JSON.parse(d.value),h.expires&&h.expires<=p?f.push(d.name):o[d.name]=h.data;for(;b=f.pop();)a.removeAttribute(b);a.save("amplify");return o}b=b.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");if(d===g)if(h=(d=a.getAttribute(b))?JSON.parse(d):{expires:-1},h.expires&&h.expires<=p)a.removeAttribute(b);else return h.data;else d===null?a.removeAttribute(b):
(f=a.getAttribute(b),h=JSON.stringify({data:d,expires:c.expires?p+c.expires:null}),a.setAttribute(b,h));try{a.save("amplify")}catch(i){f===null?a.removeAttribute(b):a.setAttribute(b,f);e.userData();try{a.setAttribute(b,h),a.save("amplify")}catch(j){throw f===null?a.removeAttribute(b):a.setAttribute(b,f),e.error();}}return o})}})();(function(){var a={},d={};e.addType("memory",function(b,c,h){if(!b)return a===g?g:JSON.parse(JSON.stringify(a));if(c===g)return a[b]===g?g:JSON.parse(JSON.stringify(a[b]));
d[b]&&(clearTimeout(d[b]),delete d[b]);if(c===null)return delete a[b],null;a[b]=c;h.expires&&(d[b]=setTimeout(function(){delete a[b];delete d[b]},h.expires));return c})})()})(this.amplify=this.amplify||{});
(function(c){function g(){}function i(c){var g=!1;setTimeout(function(){g=!0},1);return function(){var f=this,a=arguments;g?c.apply(f,a):setTimeout(function(){c.apply(f,a)},1)}}c.request=function(e,j,f){var a=e||{};typeof a==="string"&&({}.toString.call(j)==="[object Function]"&&(f=j,j={}),a={resourceId:e,data:j||{},success:f});var e={abort:g},j=c.request.resources[a.resourceId],h=a.success||g,n=a.error||g;a.success=i(function(d,b){b=b||"success";c.publish("request.success",a,d,b);c.publish("request.complete",
a,d,b);h(d,b)});a.error=i(function(d,b){b=b||"error";c.publish("request.error",a,d,b);c.publish("request.complete",a,d,b);n(d,b)});if(!j){if(!a.resourceId)throw"amplify.request: no resourceId provided";throw"amplify.request: unknown resourceId: "+a.resourceId;}if(c.publish("request.before",a))return c.request.resources[a.resourceId](a,e),e;else a.error(null,"abort")};c.request.types={};c.request.resources={};c.request.define=function(e,g,f){if(typeof g==="string"){if(!(g in c.request.types))throw"amplify.request.define: unknown type: "+
g;f.resourceId=e;c.request.resources[e]=c.request.types[g](f)}else c.request.resources[e]=g}})(amplify);
(function(c,g,i){var e=["status","statusText","responseText","responseXML","readyState"],j=/\{([^\}]+)\}/g;c.request.types.ajax=function(a){a=g.extend({type:"GET"},a);return function(h,f){function d(a,c){g.each(e,function(a,c){try{l[c]=b[c]}catch(d){}});if(/OK$/.test(l.statusText))l.statusText="success";a===i&&(a=null);j&&(c="abort");/timeout|error|abort/.test(c)?l.error(a,c):l.success(a,c);d=g.noop}var b,k=f.abort,m=g.extend(!0,{},a,{data:h.data}),j=!1,l={readyState:0,setRequestHeader:function(a,
c){return b.setRequestHeader(a,c)},getAllResponseHeaders:function(){return b.getAllResponseHeaders()},getResponseHeader:function(a){return b.getResponseHeader(a)},overrideMimeType:function(a){return b.overrideMideType(a)},abort:function(){j=!0;try{b.abort()}catch(a){}d(null,"abort")},success:function(a,b){h.success(a,b)},error:function(a,b){h.error(a,b)}};c.publish("request.ajax.preprocess",a,h,m,l);g.extend(m,{success:function(a,b){d(a,b)},error:function(a,b){d(null,b)},beforeSend:function(d,e){b=
d;m=e;return(a.beforeSend?a.beforeSend.call(this,l,m):!0)&&c.publish("request.before.ajax",a,h,m,l)}});g.ajax(m);f.abort=function(){l.abort();k.call(this)}}};c.subscribe("request.ajax.preprocess",function(a,c,e){var d=[],b=e.data;if(typeof b!=="string")b=g.extend(!0,{},a.data,b),e.url=e.url.replace(j,function(a,c){if(c in b)return d.push(c),b[c]}),g.each(d,function(a,c){delete b[c]}),e.data=b});c.subscribe("request.ajax.preprocess",function(a,c,e){var d=e.data;if((c=a.dataMap)&&typeof d!=="string")g.isFunction(c)?
e.data=c(d):(g.each(a.dataMap,function(a,c){a in d&&(d[c]=d[a],delete d[a])}),e.data=d)});var f=c.request.cache={_key:function(a,c,e){function d(){return e.charCodeAt(b++)<<24|e.charCodeAt(b++)<<16|e.charCodeAt(b++)<<8|e.charCodeAt(b++)<<0}for(var e=c+e,c=e.length,b=0,f=d();b<c;)f^=d();return"request-"+a+"-"+f},_default:function(){var a={};return function(c,e,d,b){var g=f._key(e.resourceId,d.url,d.data),i=c.cache;if(g in a)return b.success(a[g]),!1;var j=b.success;b.success=function(b){a[g]=b;typeof i===
"number"&&setTimeout(function(){delete a[g]},i);j.apply(this,arguments)}}}()};if(c.store)g.each(c.store.types,function(a){f[a]=function(e,g,d,b){var i=f._key(g.resourceId,d.url,d.data);if(g=c.store[a](i))return d.success(g),!1;var j=b.success;b.success=function(b){c.store[a](i,b,{expires:e.cache.expires});j.apply(this,arguments)}}}),f.persist=f[c.store.type];c.subscribe("request.before.ajax",function(a){var c=a.cache;if(c)return c=c.type||c,f[c in f?c:"_default"].apply(this,arguments)});c.request.decoders=
{jsend:function(a,c,e,d,b){a.status==="success"?d(a.data):a.status==="fail"?b(a.data,"fail"):a.status==="error"&&(delete a.status,b(a,"error"))}};c.subscribe("request.before.ajax",function(a,e,f,d){function b(a,b){j(a,b)}function i(a,b){q(a,b)}var j=d.success,q=d.error,l=g.isFunction(a.decoder)?a.decoder:a.decoder in c.request.decoders?c.request.decoders[a.decoder]:c.request.decoders._default;if(l)d.success=function(a,c){l(a,c,d,b,i)},d.error=function(a,c){l(a,c,d,b,i)}})})(amplify,jQuery);
(function(){function q(a,c,d){if(a===c)return a!==0||1/a==1/c;if(a==null||c==null)return a===c;if(a._chain)a=a._wrapped;if(c._chain)c=c._wrapped;if(a.isEqual&&b.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&b.isFunction(c.isEqual))return c.isEqual(a);var e=l.call(a);if(e!=l.call(c))return!1;switch(e){case "[object String]":return a==String(c);case "[object Number]":return a!=+a?c!=+c:a==0?1/a==1/c:a==+c;case "[object Date]":case "[object Boolean]":return+a==+c;case "[object RegExp]":return a.source==
c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if(typeof a!="object"||typeof c!="object")return!1;for(var f=d.length;f--;)if(d[f]==a)return!0;d.push(a);var f=0,g=!0;if(e=="[object Array]"){if(f=a.length,g=f==c.length)for(;f--;)if(!(g=f in a==f in c&&q(a[f],c[f],d)))break}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return!1;for(var h in a)if(b.has(a,h)&&(f++,!(g=b.has(c,h)&&q(a[h],c[h],d))))break;if(g){for(h in c)if(b.has(c,h)&&!f--)break;
g=!f}}d.pop();return g}var r=this,G=r._,n={},k=Array.prototype,o=Object.prototype,i=k.slice,H=k.unshift,l=o.toString,I=o.hasOwnProperty,w=k.forEach,x=k.map,y=k.reduce,z=k.reduceRight,A=k.filter,B=k.every,C=k.some,p=k.indexOf,D=k.lastIndexOf,o=Array.isArray,J=Object.keys,s=Function.prototype.bind,b=function(a){return new m(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=b;exports._=b}else r._=b;b.VERSION="1.3.1";var j=b.each=b.forEach=function(a,
c,d){if(a!=null)if(w&&a.forEach===w)a.forEach(c,d);else if(a.length===+a.length)for(var e=0,f=a.length;e<f;e++){if(e in a&&c.call(d,a[e],e,a)===n)break}else for(e in a)if(b.has(a,e)&&c.call(d,a[e],e,a)===n)break};b.map=b.collect=function(a,c,b){var e=[];if(a==null)return e;if(x&&a.map===x)return a.map(c,b);j(a,function(a,g,h){e[e.length]=c.call(b,a,g,h)});if(a.length===+a.length)e.length=a.length;return e};b.reduce=b.foldl=b.inject=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(y&&
a.reduce===y)return e&&(c=b.bind(c,e)),f?a.reduce(c,d):a.reduce(c);j(a,function(a,b,i){f?d=c.call(e,d,a,b,i):(d=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};b.reduceRight=b.foldr=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(z&&a.reduceRight===z)return e&&(c=b.bind(c,e)),f?a.reduceRight(c,d):a.reduceRight(c);var g=b.toArray(a).reverse();e&&!f&&(c=b.bind(c,e));return f?b.reduce(g,c,d,e):b.reduce(g,c)};b.find=b.detect=function(a,c,b){var e;
E(a,function(a,g,h){if(c.call(b,a,g,h))return e=a,!0});return e};b.filter=b.select=function(a,c,b){var e=[];if(a==null)return e;if(A&&a.filter===A)return a.filter(c,b);j(a,function(a,g,h){c.call(b,a,g,h)&&(e[e.length]=a)});return e};b.reject=function(a,c,b){var e=[];if(a==null)return e;j(a,function(a,g,h){c.call(b,a,g,h)||(e[e.length]=a)});return e};b.every=b.all=function(a,c,b){var e=!0;if(a==null)return e;if(B&&a.every===B)return a.every(c,b);j(a,function(a,g,h){if(!(e=e&&c.call(b,a,g,h)))return n});
return e};var E=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=!1;if(a==null)return e;if(C&&a.some===C)return a.some(c,d);j(a,function(a,b,h){if(e||(e=c.call(d,a,b,h)))return n});return!!e};b.include=b.contains=function(a,c){var b=!1;if(a==null)return b;return p&&a.indexOf===p?a.indexOf(c)!=-1:b=E(a,function(a){return a===c})};b.invoke=function(a,c){var d=i.call(arguments,2);return b.map(a,function(a){return(b.isFunction(c)?c||a:a[c]).apply(a,d)})};b.pluck=function(a,c){return b.map(a,function(a){return a[c]})};
b.max=function(a,c,d){if(!c&&b.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!c&&b.isEmpty(a))return-Infinity;var e={computed:-Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b>=e.computed&&(e={value:a,computed:b})});return e.value};b.min=function(a,c,d){if(!c&&b.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!c&&b.isEmpty(a))return Infinity;var e={computed:Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b<e.computed&&(e={value:a,computed:b})});return e.value};b.shuffle=
function(a){var b=[],d;j(a,function(a,f){f==0?b[0]=a:(d=Math.floor(Math.random()*(f+1)),b[f]=b[d],b[d]=a)});return b};b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,g){return{value:a,criteria:c.call(d,a,b,g)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")};b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};j(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)});return d};b.sortedIndex=function(a,c,d){d||(d=b.identity);
for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(c)?e=g+1:f=g}return e};b.toArray=function(a){return!a?[]:a.toArray?a.toArray():b.isArray(a)?i.call(a):b.isArguments(a)?i.call(a):b.values(a)};b.size=function(a){return b.toArray(a).length};b.first=b.head=function(a,b,d){return b!=null&&!d?i.call(a,0,b):a[0]};b.initial=function(a,b,d){return i.call(a,0,a.length-(b==null||d?1:b))};b.last=function(a,b,d){return b!=null&&!d?i.call(a,Math.max(a.length-b,0)):a[a.length-1]};b.rest=b.tail=function(a,b,d){return i.call(a,
b==null||d?1:b)};b.compact=function(a){return b.filter(a,function(a){return!!a})};b.flatten=function(a,c){return b.reduce(a,function(a,e){if(b.isArray(e))return a.concat(c?e:b.flatten(e));a[a.length]=e;return a},[])};b.without=function(a){return b.difference(a,i.call(arguments,1))};b.uniq=b.unique=function(a,c,d){var d=d?b.map(a,d):a,e=[];b.reduce(d,function(d,g,h){if(0==h||(c===!0?b.last(d)!=g:!b.include(d,g)))d[d.length]=g,e[e.length]=a[h];return d},[]);return e};b.union=function(){return b.uniq(b.flatten(arguments,
!0))};b.intersection=b.intersect=function(a){var c=i.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})};b.difference=function(a){var c=b.flatten(i.call(arguments,1));return b.filter(a,function(a){return!b.include(c,a)})};b.zip=function(){for(var a=i.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),e=0;e<c;e++)d[e]=b.pluck(a,""+e);return d};b.indexOf=function(a,c,d){if(a==null)return-1;var e;if(d)return d=b.sortedIndex(a,c),a[d]===
c?d:-1;if(p&&a.indexOf===p)return a.indexOf(c);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===c)return d;return-1};b.lastIndexOf=function(a,b){if(a==null)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1};b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);for(var d=arguments[2]||1,e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=d;return g};var F=function(){};b.bind=function(a,c){var d,e;if(a.bind===s&&s)return s.apply(a,
i.call(arguments,1));if(!b.isFunction(a))throw new TypeError;e=i.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(c,e.concat(i.call(arguments)));F.prototype=a.prototype;var b=new F,g=a.apply(b,e.concat(i.call(arguments)));return Object(g)===g?g:b}};b.bindAll=function(a){var c=i.call(arguments,1);c.length==0&&(c=b.functions(a));j(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,c){var d={};c||(c=b.identity);return function(){var e=c.apply(this,arguments);
return b.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}};b.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(i.call(arguments,1)))};b.throttle=function(a,c){var d,e,f,g,h,i=b.debounce(function(){h=g=!1},c);return function(){d=this;e=arguments;var b;f||(f=setTimeout(function(){f=null;h&&a.apply(d,e);i()},c));g?h=!0:a.apply(d,e);i();g=!0}};b.debounce=function(a,b){var d;return function(){var e=this,
f=arguments;clearTimeout(d);d=setTimeout(function(){d=null;a.apply(e,f)},b)}};b.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;return d=a.apply(this,arguments)}};b.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments,0));return b.apply(this,d)}};b.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};b.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}};
b.keys=J||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],d;for(d in a)b.has(a,d)&&(c[c.length]=d);return c};b.values=function(a){return b.map(a,b.identity)};b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()};b.extend=function(a){j(i.call(arguments,1),function(b){for(var d in b)a[d]=b[d]});return a};b.defaults=function(a){j(i.call(arguments,1),function(b){for(var d in b)a[d]==null&&(a[d]=b[d])});return a};b.clone=function(a){return!b.isObject(a)?
a:b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);return a};b.isEqual=function(a,b){return q(a,b,[])};b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(b.has(a,c))return!1;return!0};b.isElement=function(a){return!!(a&&a.nodeType==1)};b.isArray=o||function(a){return l.call(a)=="[object Array]"};b.isObject=function(a){return a===Object(a)};b.isArguments=function(a){return l.call(a)=="[object Arguments]"};if(!b.isArguments(arguments))b.isArguments=
function(a){return!(!a||!b.has(a,"callee"))};b.isFunction=function(a){return l.call(a)=="[object Function]"};b.isString=function(a){return l.call(a)=="[object String]"};b.isNumber=function(a){return l.call(a)=="[object Number]"};b.isNaN=function(a){return a!==a};b.isBoolean=function(a){return a===!0||a===!1||l.call(a)=="[object Boolean]"};b.isDate=function(a){return l.call(a)=="[object Date]"};b.isRegExp=function(a){return l.call(a)=="[object RegExp]"};b.isNull=function(a){return a===null};b.isUndefined=
function(a){return a===void 0};b.has=function(a,b){return I.call(a,b)};b.noConflict=function(){r._=G;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)};b.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};b.mixin=function(a){j(b.functions(a),function(c){K(c,b[c]=a[c])})};var L=0;b.uniqueId=function(a){var b=L++;return a?a+b:b};b.templateSettings=
{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/.^/,u=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};b.template=function(a,c){var d=b.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape||t,function(a,b){return"',_.escape("+u(b)+"),'"}).replace(d.interpolate||t,function(a,b){return"',"+u(b)+",'"}).replace(d.evaluate||t,function(a,
b){return"');"+u(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return c?e(c,b):function(a){return e.call(this,a,b)}};b.chain=function(a){return b(a).chain()};var m=function(a){this._wrapped=a};b.prototype=m.prototype;var v=function(a,c){return c?b(a).chain():a},K=function(a,c){m.prototype[a]=function(){var a=i.call(arguments);H.call(a,this._wrapped);return v(c.apply(b,a),this._chain)}};
b.mixin(b);j("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=k[a];m.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var e=d.length;(a=="shift"||a=="splice")&&e===0&&delete d[0];return v(d,this._chain)}});j(["concat","join","slice"],function(a){var b=k[a];m.prototype[a]=function(){return v(b.apply(this._wrapped,arguments),this._chain)}});m.prototype.chain=function(){this._chain=!0;return this};m.prototype.value=function(){return this._wrapped}}).call(this);
(function(){var i=this,r=i.Backbone,s=Array.prototype.slice,t=Array.prototype.splice,f;f=typeof exports!=="undefined"?exports:i.Backbone={};f.VERSION="0.5.3";var g=i._;!g&&typeof require!=="undefined"&&(g=require("underscore"));var h=i.jQuery||i.Zepto||i.ender;f.noConflict=function(){i.Backbone=r;return this};f.emulateHTTP=!1;f.emulateJSON=!1;f.Events={on:function(a,b,c){for(var d,a=a.split(/\s+/),e=this._callbacks||(this._callbacks={});d=a.shift();){d=e[d]||(e[d]={});var f=d.tail||(d.tail=d.next=
{});f.callback=b;f.context=c;d.tail=f.next={}}return this},off:function(a,b,c){var d,e,f;if(a){if(e=this._callbacks)for(a=a.split(/\s+/);d=a.shift();)if(f=e[d],delete e[d],b&&f)for(;(f=f.next)&&f.next;)if(!(f.callback===b&&(!c||f.context===c)))this.on(d,f.callback,f.context)}else delete this._callbacks;return this},trigger:function(a){var b,c,d,e;if(!(d=this._callbacks))return this;e=d.all;for((a=a.split(/\s+/)).push(null);b=a.shift();)e&&a.push({next:e.next,tail:e.tail,event:b}),(c=d[b])&&a.push({next:c.next,
tail:c.tail});for(e=s.call(arguments,1);c=a.pop();){b=c.tail;for(d=c.event?[c.event].concat(e):e;(c=c.next)!==b;)c.callback.apply(c.context||this,d)}return this}};f.Events.bind=f.Events.on;f.Events.unbind=f.Events.off;f.Model=function(a,b){var c;a||(a={});b&&b.parse&&(a=this.parse(a));if(c=j(this,"defaults"))a=g.extend({},c,a);if(b&&b.collection)this.collection=b.collection;this.attributes={};this._escapedAttributes={};this.cid=g.uniqueId("c");if(!this.set(a,{silent:!0}))throw Error("Can't create an invalid model");
this._changed=!1;this._previousAttributes=g.clone(this.attributes);this.initialize.apply(this,arguments)};g.extend(f.Model.prototype,f.Events,{_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return g.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.attributes[a];return this._escapedAttributes[a]=g.escape(b==null?"":""+b)},has:function(a){return this.attributes[a]!=null},set:function(a,
b,c){var d,e;g.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b);c||(c={});if(!d)return this;if(d instanceof f.Model)d=d.attributes;if(c.unset)for(e in d)d[e]=void 0;var b=this.attributes,k=this._escapedAttributes;if(this.validate&&!this._performValidation(d,c))return!1;if(this.idAttribute in d)this.id=d[this.idAttribute];var h=this._changing;this._changing=!0;var m={};for(e in d){a=d[e];if(!g.isEqual(b[e],a)||c.unset&&e in b)delete k[e],this._changed=!0,m[e]=a;c.unset?delete b[e]:b[e]=a}for(e in m)c.silent||
this.trigger("change:"+e,this,m[e],c);if(!h)!c.silent&&this._changed&&this.change(c),this._changing=!1;return this},unset:function(a,b){(b||(b={})).unset=!0;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=!0;return this.set(g.clone(this.attributes),a)},fetch:function(a){var a=a?g.clone(a):{},b=this,c=a.success;a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)};a.error=f.wrapError(a.error,b,a);return(this.sync||f.sync).call(this,"read",this,a)},save:function(a,b,
c){var d;g.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b);c=c?g.clone(c):{};if(d&&!this[c.wait?"_performValidation":"set"](d,c))return!1;var e=this,k=c.success;c.success=function(a,b,f){b=e.parse(a,f);c.wait&&(b=g.extend(d||{},b));if(!e.set(b,c))return!1;k?k(e,a):e.trigger("sync",e,a,c)};c.error=f.wrapError(c.error,e,c);a=this.isNew()?"create":"update";return(this.sync||f.sync).call(this,a,this,c)},destroy:function(a){var a=a?g.clone(a):{},b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,
a)};if(this.isNew())return d();a.success=function(e){a.wait&&d();c?c(b,e):b.trigger("sync",b,e,a)};a.error=f.wrapError(a.error,b,a);var e=(this.sync||f.sync).call(this,"delete",this,a);a.wait||d();return e},url:function(){var a=j(this.collection,"url")||j(this,"urlRoot")||o();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(a){this.trigger("change",
this,a);this._previousAttributes=g.clone(this.attributes);this._changed=!1},hasChanged:function(a){return a?!g.isEqual(this._previousAttributes[a],this.attributes[a]):this._changed},changedAttributes:function(a){if(!this._changed)return!1;a||(a=this.attributes);var b=!1,c=this._previousAttributes,d;for(d in a)g.isEqual(c[d],a[d])||((b||(b={}))[d]=a[d]);for(d in c)d in a||((b||(b={}))[d]=void 0);return b},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return g.clone(this._previousAttributes)},
_performValidation:function(a,b){var c=this.validate(g.extend({},this.attributes,a),b);return c?(b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}});f.Collection=function(a,b){b||(b={});if(b.comparator)this.comparator=b.comparator;this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};g.extend(f.Collection.prototype,f.Events,{model:f.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,
b){var c,d,e,f={};b||(b={});a=g.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){if(!(e=a[c]=this._prepareModel(a[c],b)))throw Error("Can't add an invalid model to a collection");var h=e.id!=null;if(this._byCid[e.cid]||h&&this._byId[e.id])throw Error("Can't add the same model to a collection twice");}for(c=0;c<d;c++)(e=a[c]).on("all",this._onModelEvent,this),this._byCid[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),f[e.cid]=!0;this.length+=d;t.apply(this.models,[b.at!=null?b.at:this.models.length,
0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;for(c=0,d=this.models.length;c<d;c++)if(f[(e=this.models[c]).cid])b.index=c,e.trigger("add",e,this,b);return this},remove:function(a,b){var c,d,e,f;b||(b={});a=g.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++)if(f=this.getByCid(a[c])||this.get(a[c])){delete this._byId[f.id];delete this._byCid[f.cid];e=this.indexOf(f);this.models.splice(e,1);this.length--;if(!b.silent)b.index=e,f.trigger("remove",f,this,b);this._removeReference(f)}return this},
get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=g.bind(this.comparator,this);this.comparator.length==1?this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return g.map(this.models,function(b){return b.get(a)})},reset:function(a,
b){a||(a=[]);b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);this._reset();this.add(a,{silent:!0,parse:b.parse});b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?g.clone(a):{};if(a.parse===void 0)a.parse=!0;var b=this,c=a.success;a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=f.wrapError(a.error,b,a);return(this.sync||f.sync).call(this,"read",this,a)},create:function(a,b){var c=this,b=b?g.clone(b):
{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;b.success=function(e,f){b.wait&&c.add(e,b);d?d(e,f):e.trigger("sync",a,f,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return g(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,b){if(a instanceof f.Model){if(!a.collection)a.collection=this}else{var c;b.collection=this;a=new this.model(a,b);a.validate&&!a._performValidation(a.attributes,
b)&&(a=!1)}return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){(a=="add"||a=="remove")&&c!=this||(a=="destroy"&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments))}});g.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),
function(a){f.Collection.prototype[a]=function(){return g[a].apply(g,[this.models].concat(g.toArray(arguments)))}});f.Router=function(a){a||(a={});if(a.routes)this.routes=a.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var u=/:\w+/g,v=/\*\w+/g,w=/[-[\]{}()+?.,\\^$|#\s]/g;g.extend(f.Router.prototype,f.Events,{initialize:function(){},route:function(a,b,c){f.history||(f.history=new f.History);g.isRegExp(a)||(a=this._routeToRegExp(a));c||(c=this[b]);f.history.route(a,g.bind(function(d){d=
this._extractParameters(a,d);c&&c.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d));f.history.trigger("route",this,b,d)},this))},navigate:function(a,b){f.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(w,"\\$&").replace(u,"([^/]+)").replace(v,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,
b){return a.exec(b).slice(1)}});f.History=function(){this.handlers=[];g.bindAll(this,"checkUrl")};var n=/^[#\/]/,x=/msie [\w.]+/,l=!1;g.extend(f.History.prototype,f.Events,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){var a=window.location.pathname,c=window.location.search;c&&(a+=c)}else a=window.location.hash;a=decodeURIComponent(a.replace(n,""));a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a},start:function(a){if(l)throw Error("Backbone.history has already been started");
this.options=g.extend({},{root:"/"},this.options,a);this._wantsHashChange=this.options.hashChange!==!1;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=x.exec(navigator.userAgent.toLowerCase())&&(!b||b<=7))this.iframe=h('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);if(this._hasPushState)h(window).bind("popstate",
this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in window&&!b)h(window).bind("hashchange",this.checkUrl);else if(this._wantsHashChange)this._checkUrlInterval=setInterval(this.checkUrl,this.interval);this.fragment=a;l=!0;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;else if(this._wantsPushState&&this._hasPushState&&
b&&a.hash)this.fragment=a.hash.replace(n,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment);if(!this.options.silent)return this.loadUrl()},stop:function(){h(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);l=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.iframe.location.hash));
if(a==this.fragment||a==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return g.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!l)return!1;if(!b||b===!0)b={trigger:b};var c=(a||"").replace(n,"");if(!(this.fragment==c||this.fragment==decodeURIComponent(c)))this._hasPushState?(c.indexOf(this.options.root)!=0&&
(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,
"")+"#"+b):a.hash=b}});f.View=function(a){this.cid=g.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var y=/^(\S+)\s*(.*)$/,p="model,collection,el,id,attributes,className,tagName".split(",");g.extend(f.View.prototype,f.Events,{tagName:"div",$:function(a){return h(a,this.el)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,c){a=document.createElement(a);
b&&h(a).attr(b);c&&h(a).html(c);return a},setElement:function(a,b){this.$el=h(a);this.el=this.$el[0];b!==!1&&this.delegateEvents()},delegateEvents:function(a){if(a||(a=j(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];g.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Event "'+a[b]+'" does not exist');var d=b.match(y),e=d[1],d=d[2],c=g.bind(c,this);e+=".delegateEvents"+this.cid;d===""?this.$el.bind(e,c):this.$el.delegate(d,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+
this.cid)},_configure:function(a){this.options&&(a=g.extend({},this.options,a));for(var b=0,c=p.length;b<c;b++){var d=p[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var a=j(this,"attributes")||{};if(this.id)a.id=this.id;if(this.className)a["class"]=this.className;this.setElement(this.make(this.tagName,a),!1)}}});f.Model.extend=f.Collection.extend=f.Router.extend=f.View.extend=function(a,b){var c=z(this,a,b);c.extend=this.extend;return c};
var A={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};f.sync=function(a,b,c){var d=A[a],e={type:d,dataType:"json"};if(!c.url)e.url=j(b,"url")||o();if(!c.data&&b&&(a=="create"||a=="update"))e.contentType="application/json",e.data=JSON.stringify(b.toJSON());if(f.emulateJSON)e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{};if(f.emulateHTTP&&(d==="PUT"||d==="DELETE")){if(f.emulateJSON)e.data._method=d;e.type="POST";e.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",
d)}}if(e.type!=="GET"&&!f.emulateJSON)e.processData=!1;return h.ajax(g.extend(e,c))};f.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d;a?a(d,e,c):b.trigger("error",d,e,c)}};var q=function(){},z=function(a,b,c){var d;d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)};g.extend(d,a);q.prototype=a.prototype;d.prototype=new q;b&&g.extend(d.prototype,b);c&&g.extend(d,c);d.prototype.constructor=d;d.__super__=a.prototype;return d},j=function(a,b){return!a||!a[b]?
null:g.isFunction(a[b])?a[b]():a[b]},o=function(){throw Error('A "url" property or function must be specified');}}).call(this);
window.log=function(){log.history=log.history||[];log.history.push(arguments);if(this.console){arguments.callee=arguments.callee.caller;var a=[].slice.call(arguments);typeof console.log==="object"?log.apply.call(console.log,console,a):console.log.apply(console,a)}};
(function(a){function c(){}for(var d="assert,clear,count,debug,dir,dirxml,error,exception,firebug,group,groupCollapsed,groupEnd,info,log,memoryProfile,memoryProfileEnd,profile,profileEnd,table,time,timeEnd,timeStamp,trace,warn".split(","),b;b=d.pop();)a[b]=a[b]||c})(function(){try{return console.log(),window.console}catch(a){return window.console={}}}());
if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)){var viewportmeta=document.querySelector('meta[name="viewport"]');if(viewportmeta)viewportmeta.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0",document.body.addEventListener("gesturestart",function(){viewportmeta.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6"},!1)}var tti=tti||{};tti.routers=tti.routers||{};tti.models=tti.models||{};tti.views=tti.views||{};
(function(a){a(function(){a.getJSON("/restful/fortune",function(b){b.status=="success"?a("#fortune").html("Your fortune is: "+b.fortune):a("#fortune").html("Things do not look good, no fortune was told")})})})(jQuery);
